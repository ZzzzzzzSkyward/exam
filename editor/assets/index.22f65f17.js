var P=Object.defineProperty;var V=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var x=(e,t,i)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,v=(e,t)=>{for(var i in t||(t={}))B.call(t,i)&&x(e,i,t[i]);if(V)for(var i of V(t))H.call(t,i)&&x(e,i,t[i]);return e};var M=(e,t,i)=>(x(e,typeof t!="symbol"?t+"":t,i),i);import{d as S,V as K,E as R,e as I,a as W,n as U,c as F,h as G,i as J,s as Q,m as X,b as Z,t as Y,f as ee,u as te,g as ie,j as oe,k as ne,l as se,o as ae,p as re,r as le,q as de,v as ce,w as $,x as ue,y,z as b,D as q,T as he,A as fe,B as pe,C as j,P as L,F as E,G as O,H as ge,I as z,J as k,K as T,L as _,M as me,N as ye}from"./vendor.beb1592b.js";const ve=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}};ve();var A=(e,t)=>{for(const[i,s]of t)e[i]=s;return e};let be=`# Milkdown\u6307\u5357

## \u652F\u6301Markdown\u8BED\u6CD5

| Action | Key         |
| :----- | :---------- |
| \u5E38\u89C4\u6587\u672C   | Mod-Alt-0   |
| H1     | Mod-Alt-1   |
| H2     | Mod-Alt-2   |
| H3     | Mod-Alt-3   |
| H4     | Mod-Alt-4   |
| H5     | Mod-Alt-5   |
| H6     | Mod-Alt-6   |
| \u4EE3\u7801\u5757    | Mod-Alt-c   |
| \u5220\u9664\u6362\u884C   | Shift-Enter |

## \u652F\u6301TeX\u8BED\u6CD5

\`$\`\u4EE5\u53EC\u5524math\u63D2\u4EF6\uFF0C\u7531KaTeX\u6E32\u67D3\u3002

\u8F93\u5165\`$\\pi\`\u5C31\u53EF\u4EE5\u5F97\u5230$\\pi$\u3002

## \u5FEB\u6377\u952E

\u8BF7\u53BB<https://milkdown.dev/#/zh-hans/keyboard-shortcuts>\u67E5\u770B\u3002

## \u526A\u8D34\u677F

\u53EF\u4EE5\u590D\u5236\u7C98\u8D34markdown\u8BED\u8A00\uFF0C\u5176\u4ED6\u4E0D\u884C\u3002

## emoji~~\u{1F605}~~

\u652F\u6301\u4E00\u4E9Bemoji\uFF0C\u8F93\u5165\`:\`\u4EE5\u9009\u62E9\uFF0C\u8F93\u5165\`:emoji:\`\u4EE5\u6253\u5F00\u9762\u677F\u3002`,D={openImage(e){return"data:image/png;base64,"+window.btoa(e)}};D.uploader=async(e,t)=>{const i=[];for(let o=0;o<e.length;o++){const n=e.item(o);!n||!n.type.includes("image")||i.push(n)}return await Promise.all(i.map(async o=>{const n=await D.openImage(o),a=o.name;return t.nodes.image.createAndFill({src:n,alt:a})}))};const _e=S({name:"Milkdown",components:{VueEditor:K},props:{text:{type:String,default:be},editable:{type:Boolean,default:!0}},setup(e){console.log(e);let t=R.make().config(o=>{o.set(I,{editable(){return e.editable}}),o.set(W,e.text)}).use(U).use(F).use(G).use(J).use(Q).use(X).use(Z).use(Y).use(ee).use(te.configure(ie,{uploader:D.uploader})).use(oe).use(ne),i={markdown:[],doc:[console.log]};t.config(function(o){o.set(se,i)}).use(ae);let s=re(o=>t.config(n=>{n.set(le,o)}));return v({editor:t,ls:i,editorf:s,listeners:[]},e)},mounted(){window.milkdown=this,this.ls.markdown.push(this.attention)},methods:{async md(){return this.editor.action(e=>{const t=e.get(de);return e.get(ce)(t.state.doc)})},bind(e){this.listeners.push(e)},attention(e,t){if(t==="markdown"){this.markdown=e();for(let i of this.listeners)i(this.markdown)}else{this.data=e();for(let i of this.listeners)i(this.data)}},edit(e){arguments.length==0&&(e=this.editable),this.editor.config(t=>{t.set(I,{editable(){return e}})}),this.editable=!this.editable}}});function ke(e,t,i,s,o,n){const a=$("VueEditor");return y(),ue(a,{editor:e.editorf,ref:"ve"},null,8,["editor"])}var we=A(_e,[["render",ke]]);async function Te(e,t){if(!e||!t){console.log("language and dict needed","sample of dict:{token1:{suggestion1:val,...},...");return}const i=await fetch("src/assets/python-token.json").then(o=>o.json());e==="python"&&monaco.languages.registerCompletionItemProvider("python",{provideCompletionItems:function(o,n,a){let r=new Set;var u=o.getValueInRange({startLineNumber:n.lineNumber,startColumn:0,endLineNumber:n.lineNumber,endColumn:n.column}),l=u.replace("	","").trim().split(/[. &%/^!|=:+-/*//()]/);console.log(l);var d=l[l.length-1];for(let f in i)i[f].indexOf(d)>=0&&r.add(i[f]);let h=new RegExp("([a-zA-Z_.]\\w*)","g"),c,p=o.getValue();for(;(c=h.exec(p))!==null;)r.add(c[0]);return r.size?{suggestions:Array.from(r).map(g=>({label:g,insertText:g,kind:monaco.languages.CompletionItemKind.Variable}))}:null}});function s(o,n){n=n==null&&typeof n=="boolean"?n:!1;var a=monaco.languages.CompletionItemKind,r="Variable";switch((typeof o).toLowerCase()){case"object":r="Class";case"function":r=n?"Method":"Function";default:r=n?"Property":"Variable"}return a[r]}monaco.languages.registerCompletionItemProvider(e,{triggerCharacters:[".","("],provideCompletionItems:function(o,n,a){var r=o.getValueInRange({startLineNumber:n.lineNumber,startColumn:0,endLineNumber:n.lineNumber,endColumn:n.column}),u=r.replace("	","").split(" "),l=u[u.length-1],d=l.charAt(l.length-1)==".",h=[],c=t||{},p="";if(d){var f=l.substring(0,l.length-1).split(".");c=t[f[0]],p=f[0];for(var g=1;g<f.length;g++)if(c.hasOwnProperty(f[g]))p+="."+f[g],c=c[f[g]];else return null;p+="."}for(var m in c)if(c.hasOwnProperty(m)&&!m.startsWith("__")){var C="";try{C=c[m].__proto__.constructor.name}catch{C=typeof c[m]}var w={label:p+m,kind:s(c[m],d),detail:C,insertText:m};w.detail.toLowerCase()=="function"&&(w.insertText+="(",w.documentation=c[m].toString().split("{")[0]),h.push(w)}return h.length?{suggestions:h}:null}})}function N(e,t){return e.lastIndexOf(".json")!==-1?fetch(e).then(i=>i.json()):new Promise((i,s)=>{let o=document.createElement("script");o.type=t?"module":"text/javascript",o.src=e,document.body.appendChild(o),o.onload=()=>{i()},o.onerror=()=>{s()}})}const Ce=S({name:"Monaco",components:{},props:{editable:{type:Boolean,default:!1},type:{type:String,default:"undefined"},diff:Boolean,content:String,language:{type:String,default:"html"},options:Object,scroll:{type:Boolean,default:!0},size:String,resizable:{type:Boolean,default:!0},model:Object},setup:function(e){let t=v({},e);t.type==="edit"&&(t.editable=!0),console.log(t.editable?"editable":"ineditable");let i={editor:null,listeners:[],loading:!0,prevline:0,theme:"vs",beyond:!1,round:!1,margin:!0,model:t.model||null,cursor:"line",blink:"smooth"},s=v(v({preview:!1,ligature:!0,tab:!1,resizable:!1,minimap:!1,menu:!1,accelerate:!1,editable:!1,lightbulb:!1},i),t);return t.type==="show"?s:v(v({beyond:!1,round:!1,ligature:!1,accelerate:!0,resizable:!0,menu:!0,number:!0,scroll:!1,preview:!0,cursor:"line",tab:!0,tabText:"onlySnippets",minimap:!0,lightbulb:!0,font:"Monaco",size:"10px"},i),t)},methods:{lang(e){let t=this.editor.getModel();monaco.editor.setModelLanguage(t,e)},line(){return this.editor.getModel().getLineCount()},height(){return this.editor.getContentHeight()},sz(e){this.update({fontSize:e})},resize(e,t){e&&(this.$el.style.width=e),t&&(this.$el.style.height=t)},async finish(){this.$el.classList.remove("loading"),this.loading=!1;let e=await N("src/assets/Textmate.json");e&&(monaco.editor.defineTheme("Textmate",e),this.them("Textmate")),window.milkdown.bind(this.text),this.listeners.push(()=>{let t=this.line();t!==this.prevline&&t>10&&t<100&&(this.resize(null,this.height()+"px"),this.prevline=t)})},bind(e,t){typeof e=="string"&&(e=[e]);for(let i of e){i=i.toLowerCase();let s=monaco.KeyMod;s.CtrlCmd,s.CtrlCmd,s.AltCmd,s.Shift,s.US_OPEN_SQUARE_BRACKET,s.US_EQUAL,s.US_MINUS}switch(t){case"unfoldAll":t="unfondRecursively";break}t="editor."+t,this.editor.addCommand(key,function(){editor.trigger("",t)})},update(e){this.editor.updateOptions(e)},size(e){this.update({fontSize:e})},edit(e){this.update({readOnly:!e})},text(e){if(e!==void 0)this.editor.setValue(e);else return this.editor.getValue()},getSelectionText(e,t,i,s,o){let n="",a=0,r=null,u=null;return t<s?e.getValue().split("").map((l,d)=>{t===1?(r=i-1,l===`
`&&(a+=1,a===s-1&&(u=d+o))):l===`
`&&(a+=1,a===t-1&&(r=d+i),a===s-1&&(u=d+o))}):t>s?e.getValue().split("").map((l,d)=>{s===1?(r=o-1,l===`
`&&(a+=1,a===t-1&&(u=d+i))):l===`
`&&(a+=1,a===s-1&&(r=d+o),a===t-1&&(u=d+i))}):t===s&&e.getValue().split("").map((l,d)=>{s===1?(r=i<o?i-1:o-1,u=i>o?i-1:o-1):l===`
`&&(a+=1,a===s-1&&(r=i<o?i+d:o+d,u=i>o?i+d:o+d))}),n=e.getValue().slice(r,u),n},them(e){e==="dark"?e="vs-dark":e==="light"&&(e="vs"),this.update({theme:e})},async loadTheme(e,t){return await fetch(t).then(i=>i.json()).then(i=>{monaco.editor.defineTheme(e,i)}),this},changed(e){this.attention()},attention(){let e=this.text();for(let t of this.listeners)t(e)},select(){arguments.length&&console.log("select returns selectedText without param.");let e=this.editor.getSelection();return this.getSelectionText(this.editor,e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn)},async install(){console.log("installing monaco.");try{require}catch{await N("src/assets/require.js")}require.config({paths:{vs:"src/assets/vs"}});let e=this;require(["vs/editor/editor.main"],function(){Te("python",{Person:{name:"",age:0}}),e.generate()})},generate(){console.log("generating monaco.");let e=this;this&&(this.editor=monaco.editor[e.diff?"createDiffEditor":"create"](this.$el,{value:e.content,language:e.language,roundedSelection:e.round,scrollBeyondLastLine:e.beyond,readOnly:!e.editable,fontLigatures:e.ligature,automaticLayout:e.resizable,contextmenu:e.menu,cursorBlinking:e.blink,cursorStyle:e.cursor,autoClosingBrackets:!0,dimension:e.height?{height:e.height,width:e.width}:null,disableLayerHinting:e.accelerate,scrollbar:{alwaysConsumeMouseWheel:!e.scroll},suggest:{preview:e.preview,shareSuggestSelections:!0},mouseWheelZoom:!0,tabCompletion:e.tab,lineNumbers:e.number,theme:e.theme,wordWrap:"on",foldingStrategy:"indentation",glyphMargin:e.margin,fontFamily:e.font,minimap:{enabled:e.minimap},lightbulb:{enabled:e.lightbulb},fontSize:e.size||"10px"})),window.editor=this,this.model&&this.editor.setModel(this.model,this.language),this.editor.onDidChangeModelContent(this.changed),this.editor.colorObj=new xe(this.editor),this.finish()}},mounted:async function(){try{monaco}catch{await this.install()}},beforeDestroy(){this.editor&&this.editor.dispose()}});class xe{constructor(t){M(this,"defaultColours",["rgba(104,208,254,1)","rgba(255,255,64,1)","rgba(255,127,255,1)"]);M(this,"defaultDebounceDelay",200);this.oldDecorators=[];var i=this.defaultColours.length,s="";this.classNames=[];for(var o=0;o<i;o++){var n=this.defaultColours[o];s+=".bracket.bracket-color"+o+` {
color: `+n+`; }
`,this.classNames.push("bracket bracket-color"+o)}if(s){let r=t._domElement;var a=document.createElement("style");a.innerHTML=s,r&&r.appendChild(a),this.styleSheet=a}this.debounce=this.defaultDebounceDelay,this.editor=t,this.applyWithDebounce(),t.onDidChangeModelContent(()=>this.applyWithDebounce(t))}applyWithDebounce(t){let i=this||t.colorObj;if(!this.debounceTimer){this.debounceTimer=window.setTimeout(function(){i.apply(),i.debounceTimer=null},this.debounce);return}}apply(){if(this.oldModel&&(this.oldDecorators=this.oldModel.deltaDecorations(this.oldDecorators,[])),!!this.editor){var t=this.editor.getModel();if(!(!t||t.getLineCount()>1e5)){for(var i=[],s=this.editor.getValue(),o=/[\[\{\(]/g,n=o.exec(s),a=[];n;){var r=t.getPositionAt(n.index);let l=t.matchBracket(r);if(l==null){n=o.exec(s);continue}let d=a.length,h=a[d-1];for(;d!=0&&(h&&l[0].startLineNumber>h.endLineNumber||l[0].startLineNumber==h.endLineNumber&&l[0].startColumn>=h.endColumn);)a.pop(),d=a.length,h=a[d-1];a.push(l[1]);let c=this.classNames[d%this.classNames.length];for(let p=0;p<l.length;p++){var u={range:l[p],options:{inlineClassName:c,stickiness:monaco.editor.TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges}};i.push(u)}n=o.exec(s)}this.oldModel=t,this.oldDecorators=t.deltaDecorations(this.oldDecorators,i)}}}}const Me=["language","type","options","diff","content","size","model"];function Se(e,t,i,s,o,n){return y(),b("div",{class:"monaco-container loading",language:e.language,type:e.type,options:e.options,diff:e.diff,content:e.content,size:e.size,model:e.model},null,8,Me)}var $e=A(Ce,[["render",Se]]);const ze=q.extend({content:"paragraph"}),Ae=q.extend({content:"taskList"}),De=he.extend({content:"text*"}),Ve=S({name:"TipTap",components:{EditorContent:fe,Milkdown:we},data(){return{title:null,type:null,content:null,ydoc:new pe}},mounted(){this.title=new j({extensions:[ze,L,E,O.configure({document:this.ydoc,field:"title"})],content:"<p>No matter what you do, this will be a single paragraph."}),this.type=new j({extensions:[Ae,L,E,ge,De,O.configure({document:this.ydoc,field:"type"})],content:`
        <ul data-type="taskList">
          <li data-type="taskItem" data-checked="true">And this</li>
          <li data-type="taskItem" data-checked="false">is a task list</li>
          <li data-type="taskItem" data-checked="false">and only a task list.</li>
        </ul>
      `}),this.content="..."},computed:{json(){return{title:z(this.ydoc,"title"),type:z(this.ydoc,"type"),content:z(this.ydoc,"content")}}},beforeUnmount(){this.title.destroy(),this.type.destroy(),this.content.destroy(),this.provider.destroy()}}),Ie=["id"],qe=_("div",{class:"question-item question-title"},"\u6807\u9898Title",-1),je={key:0,class:"question-input question-input-title"},Le=_("div",{class:"question-item"},"\u9898\u578BType",-1),Ee={key:1,class:"question-input question-input-type"},Oe=_("div",{class:"question-item"},"\u6807\u7B7ETag",-1),Ne={key:2,class:"question-input question-input-type"},Pe=_("div",{class:"question-item"},"\u5185\u5BB9Content",-1),Be={key:3,class:"question-input question-input-content"},He=_("div",{class:"question-item"},"\u8F93\u51FAOutput",-1),Ke={class:"output"};function Re(e,t,i,s,o,n){const a=$("editor-content"),r=$("Milkdown");return y(),b("div",{class:"tiptap question-framwork",id:e.id,ref:"tp"},[qe,e.title?(y(),b("div",je,[k(a,{editor:e.title},null,8,["editor"])])):T("",!0),Le,e.type?(y(),b("div",Ee,[k(a,{editor:e.type},null,8,["editor"])])):T("",!0),Oe,e.tag?(y(),b("div",Ne,[k(a,{editor:e.tag},null,8,["editor"])])):T("",!0),Pe,e.content?(y(),b("div",Be,[k(r,{text:e.content},null,8,["text"])])):T("",!0),He,_("div",Ke,[_("code",null,me(e.json),1)])],8,Ie)}var We=A(Ve,[["render",Re]]);const Ue={class:"main"},Fe={setup(e){return(t,i)=>(y(),b("div",Ue,[k(We,{style:{padding:"3%"}}),k($e,{language:"markdown",size:"20px",type:"edit"})]))}};ye(Fe).mount("#app");
